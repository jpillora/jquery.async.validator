/*! jQuery Asynchronous Validator - v1.0.0 - 2012-12-14
* https://github.com/jpillora/jquery.async.validator
* Copyright (c) 2012 Jaime Pillora MIT Licensed  */

(function(){$(function(){function n(e){$.extend(this,e)}function r(e){return $(document.createElement(e))}function i(e,t,n){e.each(function(){s($(this),t,n)})}function s(e,t,r){var i=e.attr("type"),s=a(e),f=s.data("promptElement"),l=f&&f.data("promptOptions")||new n(r),c=l.showArrow&&i!=="radio",h=null,p=null,d=null;$.type(r)==="string"&&(d=r);if(f&&!t){u(f,!1);return}if(!f&&!t)return;f||(f=o(s,l)),h=f.find(".formErrorContent:first"),p=f.find(".formErrorArrow:first"),p.toggleClass("invisible",!c),h.html(t.replace("\n","<br/>")),f.removeClass("greenPopup").removeClass("blackPopup").removeClass("redPopup"),d==="pass"?f.addClass("greenPopup"):d==="load"?f.addClass("blackPopup"):f.addClass("redPopup"),clearTimeout(s.data("promptTimer"));if(l.autoHidePrompt){var v=setTimeout(function(){u(f,!1)},l.autoHideDelay);s.data("promptTimer",v)}u(f,!0)}function o(t,n){var i=r("div").addClass("formErrorWrapper"),s=r("div").addClass("formError"),o=r("div").addClass("formErrorContent");return t.data("promptElement",s),s.data("promptOptions",n),i.append(s),t.parent().css("position")==="relative"&&i.css({position:"absolute"}),s.append(e),s.append(o),t.before(i),s.css(f(t,s)),s}function u(e,t){t&&e.show();var n=e.data("promptOptions"),r=t?n.showAnimation:n.hideAnimation;e.stop()[r](n.animationDuration,function(){t||e.hide()})}function a(e){if(e.is("[type=radio]")){var t=e.parents("form:first").find("[type=radio]").filter(function(t,n){return $(n).attr("name")===e.attr("name")});e=t.first()}var n=e.prev();return n.is("span.styled,span.OBS_checkbox")&&(e=n),e}function f(e,t){var n=e.position(),r=t.parent().position(),i=e.outerHeight(),s=n.left-r.left;return $.browser.msie||(i+=n.top-r.top),{top:i-2,left:s}}var e=function(){var e,t=[];t.push('<div class="formErrorArrow">');for(e=0;e<3;++e)t.push('<div class="invisible"></div>');for(e=0;e<6;++e)t.push('<div class="line'),e<4&&t.push(" shadow"),t.push('" style="width:'),t.push(2*e+1),t.push('px;"><!-- --></div>');return t.push("</div>"),t.join("")}(),t={autoHidePrompt:!1,autoHideDelay:1e4,showArrow:!0,showAnimation:"fadeIn",hideAnimation:"fadeOut",animationDuration:600,gap:0};n.prototype=t,$(document).on("click",".formError",function(){u($(this),!1)}),$.prompt=i,$.prompt.options=function(e){$.extend(t,e)},$.fn.prompt=function(e,t){return i($(this),e,t),$(this)}}),window.console===undefined&&(window.console={isFake:!0}),window.console===undefined&&(window.console={isFake:!0});var e=["log","warn","info","group","groupCollapsed","groupEnd"];for(var t=e.length-1;t>=0;t--)window.console[e[t]]===undefined&&(window.console[e[t]]=$.noop);(function(e){function n(){if(this.suppressLog)return;s("log",this,arguments)}function r(){s("warn",this,arguments)}function i(){s("info",this,arguments)}function s(n,r,i){if(window.console===undefined||window.console.isFake===!0)return;var s=e.map(i,t);s[0]=[r.prefix,s[0],r.postfix].join("");var o=e.type(s[s.length-1])==="boolean"?s.pop():null;o===!0&&window.console.group(s[0]),s[0]&&o===null&&(e.browser.msie?window.console.log(s.join(",")):window.console[n].apply(window.console,s)),o===!1&&window.console.groupEnd()}function o(e){return{log:function(){n.apply(e,arguments)},warn:function(){r.apply(e,arguments)},info:function(){i.apply(e,arguments)}}}if(!e)return;var t=function(e){return e},u=function(t){return t=e.extend({},u.defaults,t),o(t)};u.defaults={suppressLog:!1,prefix:"",postfix:""},e.extend(u,o(u.defaults)),e.console===undefined&&(e.console=u),e.consoleNoConflict=u})(jQuery);var n=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},r=function(){var e=function(t){var n=t.split(""),r="",i=!1,s="",o=!1,u=0,a={};for(var f in n){var l=n[f];if(!i){if(l=="("){i=!0,a[r]=[];continue}l!=" "&&(r+=l)}i&&!o&&(l=="("?(s+=l,u++):l==")"&&u>0?(s+=l,s&&a[r].push(e(s)),s="",u--):l==")"&&u==0?(s&&a[r].push(s),o=!0):l==","&&u==0?(s&&a[r].push(s),s=""):s+=l)}return a};return{parse:e}}();(function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(n){function o(){!e&&this.init&&this.init.apply(this,arguments)}var r=this.prototype;e=!0;var i=new this;e=!1;for(var s in n)i[s]=typeof n[s]=="function"&&typeof r[s]=="function"&&t.test(n[s])?function(e,t){return function(){var n=this._super;this._super=r[e];var i=t.apply(this,arguments);return this._super=n,i}}(s,n[s]):n[s];return o.prototype=i,o.prototype.constructor=o,o.extend=arguments.callee,o}})();var i=Class.extend({init:function(e,t){t?this.name=t:this.name="Set_"+n(),this.array=[],this.addAll(e)},find:function(e){for(var t=0,n=this.array.length;t<n;++t)if($.isFunction(e)?e(this.get(t)):this.equals(this.get(t),e))return this.get(t);return null},get:function(e){return this.array[e]},has:function(e){return!!this.find(e)},add:function(e){return this.has(e)?!1:(this.array.push(e),!0)},addAll:function(e){if(!e)return 0;$.isArray(e)||(e=[e]);var t=0;for(var n=0,r=e.length;n<r;++n)this.add(e[n])&&t++;return t},remove:function(e){var t=[];for(var n=0,r=this.array.length;n<r;++n)this.equals(this.get(n),e)||t.push(this.get(n));return this.array=t,e},removeAll:function(){this.array=[]},equals:function(e,t){return e&&t&&e.equals!==undefined&&t.equals!==undefined?e.equals(t):e===t},each:function(e){for(var t=0,n=this.array.length;t<n;++t)e(this.get(t))},map:function(e){return $.map(this.array,e)},filter:function(e){return $.grep(this.array,e)},size:function(){return this.array.length},getArray:function(){return this.array}}),s=i.extend({init:function(e,t,n){this.type=e,this._super(t,n)},add:function(e){e instanceof this.type?this._super(e):this.log("add failed - invalid type")}});(function(e){"use strict";function h(e){d("field",e)}function p(e){d("group",e)}function d(t,n){for(var r in n)c[t][r]&&a("validator '%s' already exists",r);e.extend(!0,c[t],n)}function g(t){e.extend(!0,this,t)}function y(e,t){var n=[].slice.call(e,0);return n[0]=t+n[0],n}function E(t,r,i,s){function p(e){u("ajax error"),i.callback("There has been an error")}function g(){c.prompt(a,!1);var e=w.loading[h];while(e.length)e.pop().success.apply(r,arguments);w.loaded[h]=arguments}var o={method:"GET",timeout:15e3},a=i.triggerField||i.field,f=t.success,l=t.error,c=s.options,h=JSON?JSON.stringify(t):n(),d={success:f,error:l||p};if(w.loaded[h]){var v=w.loaded[h],m=d.success;m.apply(r,v);return}w.loading[h]||(w.loading[h]=[]),w.loading[h].push(d);if(w.loading[h].length!==1)return;c.prompt(a,"Checking...","load");var y={success:g,error:g};e.ajax(e.extend(o,t,y))}var t="1.0.0",o=e.consoleNoConflict({prefix:"asyncValidator: "}),u=o.log,a=o.warn,f=o.info,l={memoize:function(e,t){var n={};return function(){var r=t?t.apply(this,arguments):Array.prototype.join.call(arguments,"|");return Object.prototype.hasOwnProperty.call(n,r)?n[r]:n[r]=e.apply(this,arguments)}},dateToString:function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},parseDate:function(t){var n=t.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(!n)return null;var r;if(e.datepicker!==undefined)try{var i=e.datepicker.parseDate("dd/mm/yy",t);r=new Date(i)}catch(s){return null}else r=new Date(parseInt(n[3],10),parseInt(n[2],10)-1,parseInt(n[1],10));return r},isRTL:function(t){var n=e(document),r=e("body"),i=t&&t.hasClass("rtl")||t&&(t.attr("dir")||"").toLowerCase()==="rtl"||n.hasClass("rtl")||(n.attr("dir")||"").toLowerCase()==="rtl"||r.hasClass("rtl")||(r.attr("dir")||"").toLowerCase()==="rtl";return Boolean(i)}},c={field:{},group:{}},v=null;(function(){var t=l.memoize(r.parse),n=function(e,t){},i=l.memoize(function(e,t){if(e!=="field"&&e!=="group")return a("invalid rule type: '"+e+"'");var n=c[e][t];return n?new S(e,t,n):a("missing '"+e+"' rule '"+t+"'")});v=function(n){if(!!n&&n instanceof Class){var r=!1,s=null,o=[];if(n.type==="ValidationGroup")s="group";else{if(n.type!=="ValidationField")return a("cannot get rules from invalid type");s="field"}if(!n.elem)return o;var u=n.form.options.validateAttribute,f=n.elem.attr(u);if(!f)return o;var l=t("x("+f+")").x;if(!l)return o;for(var c=0,h=l.length;c<h;++c){var p=null,d=[],v=l[c];if(!v)return a("cannot execute null rule");if(e.type(v)==="string")p=v;else{if(!e.isPlainObject(v))return a('cannot execute rule of type "'+e.type(v)+'"');for(var m in v){if(p)return a("rule object should only contain 1 key");p=m}if(!p)return a("rule object should contain 1 key");d=v[p];if(!e.isArray(d))return a("invalid rule params type - must be array")}p=e.trim(p),p==="required"&&(r=!0);var g=i(s,p);g&&o.push({rule:g,params:d})}return o.required=r,o}return a("cannot get rules from non class")}})();var m={debug:!1,validateAttribute:"data-validate",validationEventTrigger:"blur",scroll:!1,focusFirstField:!0,hideErrorOnChange:!1,skipHiddenFields:!0,errorClass:"error",errorContainer:function(e){return e},onValidationComplete:function(e,t){return t},track:e.noop,prompt:function(t,n){e.type(e.prompt)==="function"&&e.prompt(t,n)}};g.prototype=m;var b=Class.extend({name:"Class",init:function(){},toString:function(){return(this.type?this.type+": ":"")+(this.name?this.name+": ":"")},log:function(){if(!m.debug)return;u.apply(this,y(arguments,this.toString()))},warn:function(){a.apply(this,y(arguments,this.toString()))},info:function(){f.apply(this,y(arguments,this.toString()))},bind:function(t){var n=this[t];n&&e.isFunction(n)&&(this[t]=e.proxy(n,this))},bindAll:function(){for(var e in this)this.bind(e)}}),w={loading:{},loaded:{}},S=b.extend({init:function(e,t,n){this.name=t,this.type=e,this.buildFn(n)},buildFn:function(t){if(e.isFunction(t)){this.fn=t,this.userObj=null,this.ready=!0;return}if(!e.isPlainObject(t))return this.warn("rule definition must be a function or an object");this.userObj=e.extend(!0,{},t);while(e.type(this.userObj.extend)==="string"){var n=this.userObj.extend.match(/^((\w+):)?(\w+)$/),r=n[2]||this.type,i=n[3];delete this.userObj.extend;if(!c[r])return this.warn("cannot extend type: '"+r+"'");var s=c[r][i];if(this.userObj===s)return this.warn("cannot extend self");if(!e.isPlainObject(s))return this.warn("cannot extend: '"+i+"'");this.userObj=e.extend(!0,{},s,this.userObj)}if(e.isFunction(this.userObj.fn))this.fn=this.userObj.fn,delete this.userObj.fn;else{if(e.type(this.userObj.regex)!=="regexp")return this.warn("rule definition lacks a function");this.fn=function(e){return function(t){var n=new RegExp(e);return t.val().match(n)?!0:t.message||"Invalid Format"}}(this.userObj.regex),delete this.userObj.regex}this.ready=!0},defaultInterface:{log:u,warn:a},defaultFieldInterface:{val:function(){return this.field.val.apply(this.field,arguments)}},defaultGroupInterface:{fields:function(e){return this.field.find(e||"input,select")}},buildInterface:function(t){var n=[];return n.push({}),n.push(this.userObj),n.push(this.defaultInterface),this.type==="field"&&n.push(this.defaultFieldInterface),this.type==="group"&&n.push(this.defaultGroupInterface),n.push(t),e.extend.apply(this,n)}}),x=null,T=null;(function(){var t=b.extend({STATUS:{NOT_STARTED:0,RUNNING:1,COMPLETE:2},init:function(e,t){this.element=e,e&&(e.executions.push(this),this.domElem=e.elem),this.parent=t,this.name=n(),this.status=this.STATUS.NOT_STARTED,this.bindAll()},toString:function(){return this._super()+(this.element||this.rule).toString()},serialize:function(t){return e.Deferred.serialize(e.map(t,function(t){return e.isFunction(t)?t:t.execute}))},parallelize:function(t){return e.Deferred.parallelize(e.map(t,function(t){return e.isFunction(t)?t:t.execute}))},execute:function(){this.log("execute",!0),this.status=this.STATUS.RUNNING},executed:function(e){this.log("",!1),this.log("done: "+e),this.status=this.STATUS.COMPLETE},skipValidations:function(){return this.element.form.options.skipHiddenFields&&(!this.domElem.hasClass("styled")&&this.domElem.is(":hidden")||this.domElem.hasClass("styled")&&this.domElem.parents(":hidden").length>0)?!0:this.domElem.is("[disabled]")?!0:!1}});x=t.extend({type:"FormExecution",init:function(e){this._super(e),this.errors=[],this.ajaxs=[];var t=this;this.executables=[],this.element.fieldsets.map(function(e){t.executables.push(new r(e,t))})},execute:function(){return this._super(),this.log("exec groups #"+this.executables.length),this.domElem.triggerHandler("validating"),this.parallelize(this.executables).always(this.executed)},executed:function(e){this._super(e),this.element.info("result: "+(e===undefined?"Passed":"Failed: "+e)),this.domElem.triggerHandler("validated",arguments)}});var r=t.extend({type:"GroupExecution",init:function(e,t){this._super(e,t)},execute:function(){this._super();if(this.skipValidations())return e.Deferred().always(this.executed).resolve().promise();this.log("getting group rules");var t=v(this.element),n=e.map(t,e.proxy(function(e){return new i(e,this)},this));this.beforeRules=[],this.afterRules=[];for(var r=0,s=n.length;r<s;++r){var o=n[r];o.rule.userObj&&o.rule.userObj.run==="after"?this.afterRules.push(o):this.beforeRules.push(o)}if(this.parent instanceof T&&this.afterRules.length===0){var u=this.parent;u.group=this,this.fields=[u]}else this.fields=this.element.fields.map(e.proxy(function(e){return new T(e,this)},this));this.log("exec");var a=[];return this.beforeRules.length>0&&a.push(this.execBefore),a.push(this.execFields),this.afterRules.length>0&&a.push(this.execAfter),this.serialize(a).always(this.executed)},execBefore:function(){return this.log("before rules #%s",this.beforeRules.length),this.serialize(this.beforeRules).always(this.executedBefore)},execFields:function(){return this.log("exec fields #%s",this.fields.length),this.parallelize(this.fields).always(this.executedFields)},execAfter:function(){return this.log("after rules #%s",this.afterRules.length),this.serialize(this.afterRules).always(this.executedAfter)},executedBefore:function(e){this.executedBeforeAfter(e)},executedFields:function(e){},executedAfter:function(e){this.executedBeforeAfter(e)},executedBeforeAfter:function(e){var t=!!e,n=this.element.form.options;this.element.fields.each(function(e){n.prompt(e.elem,!1),n.errorClass&&n.errorContainer(e.elem).toggleClass(n.errorClass,t)});var r=this.triggerField();r||(r=this.element.fields.array[0]&&this.element.fields.array[0].elem),r&&n.prompt(r,e),this.parent instanceof T&&this.parent.element.options.track("Validate Group",this.parent.element.name+";"+(this.domElem.attr("data-validate")||"non_group"),t?e:"Valid",t?0:1)},executed:function(e){this._super();var t=!!e},triggerField:function(){return this.parent instanceof T?this.parent.domElem:null}});T=t.extend({type:"FieldExecution",init:function(e,t){this._super(e,t),this.children=[],t instanceof r&&(this.group=t)},execute:function(){this._super(),this.skip=!0;if(!this.group&&this.element.fieldset.nongroup===!1)return this.log("redirect to group exec: "+this.element.name),this.group=new r(this.element.fieldset,this),this.group.execute().always(function(){u("",!1)});this.domElem.triggerHandler("validating");var t=v(this.element),n=null;if(this.skipValidations())this.log("skip");else if(!t.required&&!e.trim(this.domElem.val()))this.log("not required");else if(e.isArray(t)&&t.length){var s=this,o=e.map(t,function(e){return new i(e,s)});this.log("exec rules #%s",o.length),n=this.serialize(o),this.skip=!1}else this.log("no validators");return this.skip===!0&&(n=e.Deferred(),n.resolve()),n.always(this.executed),n.promise()},executed:function(e){this._super(e),this.log("validated");var t=!!e,n=this.element.form.options;n.prompt(this.domElem,e),this.domElem.triggerHandler("validated",[e]),n.errorClass&&n.errorContainer(this.domElem).toggleClass(n.errorClass,t);var r=this.parent,i=r&&r.parent,s=null,o=!1;t&&i&&i instanceof x&&this.parent.parent.errors.push({message:e,field:this.domElem}),r&&(s=r.triggerField()),o=s?s.equals(this.domElem):!0,o&&(!r||r.parent instanceof T)&&this.element.options.track("Validate Field",this.element.form.name+" "+this.element.name,t?e:this.skip?"Skip":"Valid",t?0:1)}});var i=t.extend({type:"RuleExecution",init:function(e,t){this._super(null,t),this.rule=e.rule,this.params=e.params,this.validationElem=this.parent.element,this.options=this.validationElem.options},execute:function(){this._super();var t=e.Deferred(),n=this.rule,i=this;t.always(this.executed);var s=0,o=function(e){clearTimeout(u),s++,i.log("callback #"+s+" with: "+e);if(s>1)return;var n=e===undefined||e===!0;n?t.resolve():t.reject(e)};if(!this.validationElem||!n.ready)return this.warn(this.validationElem?"not ready.":"invalid parent."),o(),t.promise();this.log("run");var u=setTimeout(function(){i.warn("timeout!"),o("Timeout")},1e4),a={},f=null;this.parent instanceof r&&(a.triggerField=this.parent.triggerField()),a.field=this.validationElem.elem,a.form=this.validationElem.form.elem,a.callback=o,a.params=this.params,a.args=this.params,a.ajax=function(e){E(e,n,a,this.options)};var l=n.buildInterface(a),c=n.fn(l);return c!==undefined&&o(c),t.promise()}})})();var N=null;(function(){var t=b.extend({type:"ValidationElement",init:function(e){return this.bindAll(),this.elem=e,this.setName(),this.executions=[],!e.length||e.data("asyncValidator")?!1:(e&&e.data("asyncValidator",this),!0)},setName:function(){var e=null;this.elem&&(e=this.elem.attr("name")||this.elem.attr("id")),e||(e=n()),this.name=e},equals:function(e){var n,r;return this.elem?(n=this.elem,e.jquery?r=e:e instanceof t&&e.elem&&(r=e.elem),n&&r?n.equals(r):!1):!1},print:function(){function e(e){if(!(e instanceof t))return;e.print()}this instanceof r&&this.log(">");for(var n in this){var s=this[n];if(!(s instanceof i))continue;this.log(n+" #"+s.size(),!0),s.each(e),this.log(undefined,!1)}}}),r=t.extend({type:"ValidationField",init:function(e,t){if(!this._super(e))return;this.form=t,this.options=t.options,this.ruleNames=null,this.fieldset=null},validate:function(e){var t=new T(this);return t.execute().always(e),undefined}}),o=t.extend({type:"ValidationGroup",nongroup:!1,init:function(e,t){this._super(e);if(!e||!e.jquery)return;e.length||(this.nongroup=!0,this.name+="_nongroup"),this.form=t,this.options=t.options,this.fields=new s(r)}});N=t.extend({type:"ValidationForm",init:function(t,n){if(!t.length)return;if(!t.is("form"))return;if(!this._super(t))return;this.options=new g(n),this.fields=new s(r),this.fieldsets=new s(o),this.fieldByName={},this.invalidFields={},this.fieldHistory={},this.submitResult=undefined,this.submitPending=!1,this.cache={ruleNames:{},ajax:{loading:{},loaded:{}}},e(document).ready(this.bindEvents)},extendOptions:function(t){e.extend(!0,this.options,t)},bindEvents:function(){this.elem.on("keyup.jqv","input",this.onKeyup).on("blur.jqv","input[type=text]:not(.hasDatepicker),input:not([type].hasDatepicker)",this.onValidate).on("change.jqv","input[type=text].hasDatepicker",this.onValidate).on("change.jqv","select,[type=checkbox],[type=radio]",this.onValidate).on("submit.jqv",this.onSubmit).on("validated.jqv",this.scrollFocus).trigger("initialised.jqv"),this.updateFields(),this.info("bound to "+this.fields.size()+" elems")},unbindEvents:function(){this.elem.off(".jqv")},updateFields:function(){var e="["+this.options.validateAttribute+"]";this.elem.find(e).each(this.updateField)},updateField:function(t,n){t.jquery!==undefined&&(n=t),n.jquery===undefined&&(n=e(n));var i="input,select,textarea",s,u,a,f;return n.is(i)?u=n:f=n,u&&(s=this.fields.find(u),s||(s=new r(u,this),this.fields.add(s)),f=u.parentsUntil(this.elem,"["+this.options.validateAttribute+"]:first")),a=this.fieldsets.find(f),a||(a=new o(f,this),this.fieldsets.add(a)),s?(a.fields.add(s),s.fieldset=a):f.find(i).each(this.updateField),s},onSubmit:function(e){var t=!1;this.submitPending&&this.warn("pending...");if(!this.submitPending&&this.submitResult===undefined){this.submitPending=!0;var n=this;this.validate(function(e){n.submitPending=!1,n.submitResult=!e,n.elem.submit(),n.submitResult=undefined})}else this.submitResult!==undefined&&(t=this.options.onValidationComplete(e,this.submitResult));return t||e.preventDefault(),t},onKeyup:function(t){this.options.hideErrorOnChange&&this.options.prompt(e(t.currentTarget),!1)},onValidate:function(t){var n=e(t.currentTarget),r=n.data("asyncValidator")||this.updateField(n);r.log("validate"),r.validate(e.noop)},validate:function(e){this.updateFields();var t=new x(this);return t.execute().always(e),undefined},scrollFocus:function(){var e=this.executions[this.executions.length-1];if(!e.errors.length)return;var t=e.errors[0].field,n=this.options.focusFirstField&&t.is("input[type=text]");this.options.scroll?t.scrollView(function(){n&&t.focus()}):n&&t.focus()}})})(),e.fn.scrollView=function(t){return this.each(function(){var n=e(this);n.is(".styled")&&(n=n.siblings("span")),e("html, body").animate({scrollTop:Math.max(0,n.offset().top-100)},{duration:1e3,complete:t||e.noop})})},e.fn.equals=function(t){if(e(this).length!==t.length)return!1;for(var n=0,r=e(this).length;n<r;++n)if(e(this)[n]!==t[n])return!1;return!0},e.Deferred.serialize=function(t){if(!e.isArray(t)||t.length===0)return e.Deferred().resolve().promise();var n=t[0](),r=1,i=t.length;for(;r<i;r++)n=n.pipe(t[r]);return n},e.Deferred.parallelize=function(t){function u(e){r++,r===s&&n.resolve(e)}function a(e){if(o)return;o=!0,n.reject(e)}var n=e.Deferred(),r=0,i=0,s=t.length,o=!1;if(!e.isArray(t)||s===0)return n.resolve();for(;i<s;++i)t[i]().done(u).fail(a);return n.promise()},e.fn.validate=function(t){var n=e(this).data("asyncValidator");n?n.validate(t):a("element does not have async validator attached")},e.fn.validate.version=t,e.fn.asyncValidator=function(t){return this.each(function(n){var r=e.asyncValidator.forms.find(e(this));if(t===!1||t==="destroy"){r&&(r.unbindEvents(),e.asyncValidator.forms.remove(r));return}r?r.extendOptions(t):(r=new N(e(this),t),e.asyncValidator.forms.add(r))})},e.asyncValidator=function(t){e.extend(m,t)},e.extend(e.asyncValidator,{version:t,addFieldRules:h,addGroupRules:p,log:f,warn:a,defaults:m,globals:m,utils:l,forms:new s(N,[],"FormSet")}),e(function(){e("form").filter(function(){return e(this).find("[data-validate]").length>0}).asyncValidator()}),u("plugin added.")})(jQuery),function(e){if(e.asyncValidator===undefined){window.alert("Please include jquery.async.validator.js before each rule file");return}e.asyncValidator.addFieldRules({currency:{regex:/^\$?\d+(,\d+)*(\.\d+)?$/,message:"Invalid monetary value"},email:{regex:/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"Invalid email address"},alphanumeric:{regex:/^[0-9A-Za-z]+$/,message:"Use numbers and letters only"},street_number:{regex:/^\d+[A-Za-z]?(-\d+)?[A-Za-z]?$/,message:"Street Number only"},number:{regex:/^\d+$/,message:"Use numbers only"},numberSpace:{regex:/^[\d\ ]+$/,message:"Use numbers and spaces only"},postcode:{regex:/^\d{4}$/,message:"Invalid postcode"},date:{fn:function(t){return e.asyncValidator.utils.parseDate(t.val())?!0:t.message},message:"Invalid date"},required:{fn:function(e){return e.requiredField(e,e.field)},requiredField:function(t,n){var r=n.val();switch(n.prop("type")){case"radio":case"checkbox":var i=n.attr("name");if(t.form.find("input[name='"+i+"']:checked").size()===0)return t.form.find("input[name='"+i+"']").size()===1?t.messages.checkboxSingle:t.messages.checkboxMultiple;break;default:if(!e.trim(r))return t.messages.all}return!0},messages:{all:"This field is required",checkboxMultiple:"Please select an option",checkboxSingle:"This checkbox is required"}},regex:{fn:function(e){var t;try{var n=e.params[0];t=new RegExp(n)}catch(r){return e.warn("Invalid regex: "+n),!0}return e.val().match(t)?!0:e.message||"Invalid Format"},message:"Invalid format"},asyncTest:function(e){e.prompt("Please wait..."),setTimeout(function(){e.callback()},2e3)},phone:function(e){var t=e.val();return t.match(/^[\d\s]+$/)?t.match(/^0/)?t.replace(/\s/g,"").length!==10?"Must be 10 numbers long":!0:"Number must start with 0":"Use numbers and spaces only"},size:function(e){var t=e.val(),n=e.params[0],r=e.params[1];if(n!==undefined&&r===undefined){var i=parseInt(n,10);if(e.val().length!==i)return"Must be "+i+" characters"}else if(n!==undefined&&r!==undefined){var s=parseInt(n,10);r=parseInt(r,10);if(t.length<s||r<t.length)return"Must be between "+s+" and "+r+" characters"}else console.log("size validator parameter error on field: "+e.field.attr("name"));return!0},min:function(e){var t=e.val(),n=parseInt(e.params[0],10);return t.length<n?"Must be at least "+n+" characters":!0},max:function(e){var t=e.val(),n=parseInt(e.params[0],10);return t.length>n?"Must be at most "+n+" characters":!0},decimal:function(e){var t=e.val(),n=e.params[0]?parseInt(e.params[0],10):2;if(!t.match(/^\d+(,\d{3})*(\.\d+)?$/))return"Invalid decimal value";var r=parseFloat(t.replace(/[^\d\.]/g,"")),i=Math.pow(10,n);return r=Math.round(r*i)/i,e.field.val(r),!0},min_val:function(e){var t=parseFloat(e.val().replace(/[^\d\.]/g,"")),n=e.params[1]||"",r=parseFloat(e.params[0]);return t<r?"Must be greater than "+r+n:!0},max_val:function(e){var t=parseFloat(e.val().replace(/[^\d\.]/g,"")),n=e.params[1]||"",r=parseFloat(e.params[0]);return t>r?"Must be less than "+r+n:!0},range_val:function(e){var t=parseFloat(e.val().replace(/[^\d\.]/g,"")),n=e.params[2]||"",r=e.params[3]||"",i=parseFloat(e.params[0]),s=parseFloat(e.params[1]);return t>s||t<i?"Must be between "+n+i+r+"\nand "+n+s+r:!0},agreement:function(e){return e.field.is(":checked")?!0:"You must agree to continue"},minAge:function(t){var n=t.params[0];if(!n||isNaN(parseInt(n,10)))return console.log("WARNING: Invalid Age Param: "+n),!0;var r=new Date,i=new Date;i.setFullYear(i.getFullYear()-parseInt(n,10));var s=e.asyncValidator.utils.parseDate(t.val());return s==="Invalid Date"?"Invalid Date":s>i?"You must be at least "+n:!0}}),e.asyncValidator.addGroupRules({required:{run:"before",extend:"field:required",fn:function(t){var n=!0;return t.fields().each(function(){if(n!==!0)return;n=t.requiredField(t,e(this))}),n}},min_checks:{run:"before",fn:function(e){var t=e.fields("input[type=checkbox]:checked"),n=parseInt(e.params[0],10);return t.length<n?"You must choose at least "+(n===1?"one":n):!0}}})}(jQuery)})();